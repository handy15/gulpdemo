!function(e){var l={inputClass:"",invalid:[],rtl:!1,group:!1,groupLabel:"Groups"};e.mobiscroll.presetShort("select"),e.mobiscroll.presets.select=function(t){function a(){var l,t=0,a=[],n=[],s=[[]];return p.group?(p.rtl&&(t=1),e("optgroup",f).each(function(l){a.push(e(this).attr("label")),n.push(l)}),s[t]=[{values:a,keys:n,label:p.groupLabel}],l=m,t+=p.rtl?-1:1):l=f,a=[],n=[],e("option",l).each(function(){var l=e(this).attr("value");a.push(e(this).text()),n.push(l),e(this).prop("disabled")&&C.push(l)}),s[t]=[{values:a,keys:n,label:y}],s}function n(e,l){var a=[];if(h){var n=[],s=0;for(s in t._selectedValues)n.push(T[s]),a.push(s);d.val(n.join(", "))}else d.val(e),a=l?t.values[i]:null;l&&(r=!0,f.val(a).trigger("change"))}function s(e){if(h&&e.hasClass("dw-v")&&e.closest(".dw").find(".dw-ul").index(e.closest(".dw-ul"))==i){var l=e.attr("data-val"),a=e.hasClass("dw-msel");return a?(e.removeClass("dw-msel").removeAttr("aria-selected"),delete t._selectedValues[l]):(e.addClass("dw-msel").attr("aria-selected","true"),t._selectedValues[l]=l),"inline"==p.display&&n(l,!0),!1}}var r,o,i,u,d,c,v=e.extend({},t.settings),p=e.extend(t.settings,l,v),f=e(this),h=f.prop("multiple"),w=this.id+"_dummy",g=h?f.val()?f.val()[0]:e("option",f).attr("value"):f.val(),m=f.find('option[value="'+g+'"]').parent(),V=m.index()+"",_=V,x=(e('label[for="'+this.id+'"]').attr("for",w),e('label[for="'+w+'"]')),y=void 0!==p.label?p.label:x.length?x.text():f.attr("name"),C=[],b=[],T={},k=p.readonly;p.group&&!e("optgroup",f).length&&(p.group=!1),p.invalid.length||(p.invalid=C),p.group?p.rtl?(o=1,i=0):(o=0,i=1):(o=-1,i=0),e("#"+w).remove(),d=e('<input type="text" id="'+w+'" class="'+p.inputClass+'" readonly />').insertBefore(f),e("option",f).each(function(){T[e(this).attr("value")]=e(this).text()}),p.showOnFocus&&d.focus(function(){t.show()}),p.showOnTap&&t.tap(d,function(){t.show()});var q=f.val()||[],A=0;for(A;A<q.length;A++)t._selectedValues[q[A]]=q[A];return n(T[g]),f.off(".dwsel").on("change.dwsel",function(){r||t.setValue(h?f.val()||[]:[f.val()],!0),r=!1}).hide().closest(".ui-field-contain").trigger("create"),t._setValue||(t._setValue=t.setValue),t.setValue=function(l,s,r,o,u){var d,c=e.isArray(l)?l[0]:l;if(g=void 0!==c?c:e("option",f).attr("value"),h){t._selectedValues={};var v=0;for(v;v<l.length;v++)t._selectedValues[l[v]]=l[v]}if(p.group?(m=f.find('option[value="'+g+'"]').parent(),_=m.index(),d=p.rtl?[g,m.index()]:[m.index(),g],_!==V&&(p.wheels=a(),t.changeWheel([i]),V=_+"")):d=[g],t._setValue(d,s,r,o,u),s){var w=h?!0:g!==f.val();n(T[g],w)}},t.getValue=function(e){var l=e?t.temp:t.values;return l[i]},{width:50,wheels:c,headerText:!1,multiple:h,anchor:d,formatResult:function(e){return T[e[i]]},parseValue:function(){var l=f.val()||[],a=0;if(h)for(t._selectedValues={},a;a<l.length;a++)t._selectedValues[l[a]]=l[a];return g=h?f.val()?f.val()[0]:e("option",f).attr("value"):f.val(),m=f.find('option[value="'+g+'"]').parent(),_=m.index(),V=_+"",p.group&&p.rtl?[g,_]:p.group?[_,g]:[g]},validate:function(l,n,s){if(void 0===n&&h){var r=t._selectedValues,d=0;e(".dwwl"+i+" .dw-li",l).removeClass("dw-msel").removeAttr("aria-selected");for(d in r)e(".dwwl"+i+' .dw-li[data-val="'+r[d]+'"]',l).addClass("dw-msel").attr("aria-selected","true")}if(n===o)if(_=t.temp[o],_!==V){if(m=f.find("optgroup").eq(_),_=m.index(),g=m.find("option").eq(0).val(),g=g||f.val(),p.wheels=a(),p.group)return t.temp=p.rtl?[g,_]:[_,g],p.readonly=[p.rtl,!p.rtl],clearTimeout(u),u=setTimeout(function(){t.changeWheel([i]),p.readonly=k,V=_+""},1e3*s),!1}else p.readonly=k;else g=t.temp[i];var c=e(".dw-ul",l).eq(i);e.each(p.invalid,function(l,t){e('.dw-li[data-val="'+t+'"]',c).removeClass("dw-v")})},onBeforeShow:function(e){p.wheels=a(),p.group&&(t.temp=p.rtl?[g,m.index()]:[m.index(),g])},onMarkupReady:function(l){if(e(".dwwl"+o,l).on("mousedown touchstart",function(){clearTimeout(u)}),h){l.addClass("dwms"),e(".dwwl",l).eq(i).addClass("dwwms").attr("aria-multiselectable","true"),e(".dwwl",l).on("keydown",function(l){32==l.keyCode&&(l.preventDefault(),l.stopPropagation(),s(e(".dw-sel",this)))}),b={};var a;for(a in t._selectedValues)b[a]=t._selectedValues[a]}},onValueTap:s,onSelect:function(e){n(e,!0),p.group&&(t.values=null)},onCancel:function(){if(p.group&&(t.values=null),h){t._selectedValues={};var e;for(e in b)t._selectedValues[e]=b[e]}},onChange:function(e){"inline"!=p.display||h||(d.val(e),r=!0,f.val(t.temp[i]).trigger("change"))},onClose:function(){d.blur()}}}}(jQuery);