!function(t,e){"function"==typeof define&&define.amd&&console.log(!0),"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?(process.browser&&require("./d3.slider.css"),module.exports=e(require("d3"))):t.d3.slider=e(t.d3)}(this,function(t){return function(){"use strict";function e(e){e.each(function(){function e(e){"boolean"==typeof y&&(y=t.svg.axis().ticks(Math.round(f/100)).tickFormat(w).orient("horizontal"===p?"bottom":"right")),s=l.ticks?l.copy().range([0,f]):l.copy().rangePoints([0,f],.5),y.scale(s);var n=e.append("svg").classed("d3-slider-axis d3-slider-axis-"+y.orient(),!0).on("click",F),r=n.append("g");"horizontal"===p?(n.style("margin-left",-m+"px"),n.attr({width:f+2*m,height:m}),"top"===y.orient()?(n.style("top",-m+"px"),r.attr("transform","translate("+m+","+m+")")):r.attr("transform","translate("+m+",0)")):(n.style("top",-m+"px"),n.attr({width:m,height:f+2*m}),"left"===y.orient()?(n.style("left",-m+"px"),r.attr("transform","translate("+m+","+m+")")):r.attr("transform","translate(0,"+m+")")),r.call(y)}function v(){if("array"!=i(o)){var e=Math.max(0,Math.min(f,t.event.offsetX||t.event.layerX));n(l.invert?r(l.invert(e/f)):a(e/f))}}function g(){if("array"!=i(o)){var e=f-Math.max(0,Math.min(f,t.event.offsetY||t.event.layerY));n(l.invert?r(l.invert(e/f)):a(e/f))}}function b(){"handle-one"===t.event.sourceEvent.target.id?x=1:"handle-two"==t.event.sourceEvent.target.id&&(x=2);var e=Math.max(0,Math.min(f,t.event.x));n(l.invert?r(l.invert(e/f)):a(e/f))}function E(){"handle-one"===t.event.sourceEvent.target.id?x=1:"handle-two"==t.event.sourceEvent.target.id&&(x=2);var e=f-Math.max(0,Math.min(f,t.event.y));n(l.invert?r(l.invert(e/f)):a(e/f))}function F(){t.event.stopPropagation()}l||(l=t.scale.linear().domain([h,u])),o=o||l.domain()[0];var q=t.select(this).classed("d3-slider d3-slider-"+p,!0),I=t.behavior.drag();if(I.on("dragend",function(){k.slideend(t.event,o)}),"array"==i(o)&&2==o.length?(d=q.append("a").classed("d3-slider-handle",!0).attr("xlink:href","#").attr("id","handle-one").on("click",F).call(I),z=q.append("a").classed("d3-slider-handle",!0).attr("id","handle-two").attr("xlink:href","#").on("click",F).call(I)):d=q.append("a").classed("d3-slider-handle",!0).attr("xlink:href","#").attr("id","handle-one").on("click",F).call(I),"horizontal"===p){if(q.on("click",v),"array"==i(o)&&2==o.length){c=t.select(this).append("div").classed("d3-slider-range",!0),d.style("left",M(l(o[0]))),c.style("left",M(l(o[0]))),I.on("drag",b);var P=100-parseFloat(M(l(o[1])));z.style("left",M(l(o[1]))),c.style("right",P+"%"),I.on("drag",b)}else d.style("left",M(l(o))),I.on("drag",b);f=parseInt(q.style("width"),10)}else{if(q.on("click",g),I.on("drag",E),"array"==i(o)&&2==o.length){c=t.select(this).append("div").classed("d3-slider-range-vertical",!0),d.style("bottom",M(l(o[0]))),c.style("bottom",M(l(o[0]))),I.on("drag",E);var T=100-parseFloat(M(l(o[1])));z.style("bottom",M(l(o[1]))),c.style("top",T+"%"),I.on("drag",E)}else d.style("bottom",M(l(o))),I.on("drag",E);f=parseInt(q.style("height"),10)}y&&e(q)})}function n(e){var n="array"==i(o)&&2==o.length?o[x-1]:o,a=M(l(r(n))),s=M(l(r(e))),f="horizontal"===p?"left":"bottom";if(a!==s){if("array"==i(o)&&2==o.length?(o[x-1]=e,t.event&&k.slide(t.event,o)):t.event&&k.slide(t.event.sourceEvent||t.event,o=e),o[0]>=o[1])return;if(1===x)"array"==i(o)&&2==o.length&&("left"===f?c.style("left",s):c.style("bottom",s)),g?d.transition().styleTween(f,function(){return t.interpolate(a,s)}).duration("number"==typeof g?g:250):d.style(f,s);else{var h=100-parseFloat(s),u=100-parseFloat(s);"left"===f?c.style("right",h+"%"):c.style("top",u+"%"),g?z.transition().styleTween(f,function(){return t.interpolate(a,s)}).duration("number"==typeof g?g:250):z.style(f,s)}}}function r(t){if(t===l.domain()[0]||t===l.domain()[1])return t;var e=t;if(b)e=a(l(t));else{var n=(t-l.domain()[0])%v;e=t-n,2*Math.abs(n)>=v&&(e+=n>0?v:-v)}return e}function a(t){var e=l.ticks?l.ticks():l.domain(),n=e.map(function(e){return t-l(e)}),r=-1,a=0,i=l.ticks?l.range()[1]:l.rangeExtent()[1];do r++,Math.abs(n[r])<i&&(i=Math.abs(n[r]),a=r);while(n[r]>0&&r<n.length-1);return e[a]}function i(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}var o,l,s,d,c,f,h=0,u=100,v=.01,g=!0,p="horizontal",y=!1,m=50,x=1,b=!1,k=t.dispatch("slide","slideend"),M=t.format(".2%"),w=t.format(".0"),z=null;return e.min=function(t){return arguments.length?(h=t,e):h},e.max=function(t){return arguments.length?(u=t,e):u},e.step=function(t){return arguments.length?(v=t,e):v},e.animate=function(t){return arguments.length?(g=t,e):g},e.orientation=function(t){return arguments.length?(p=t,e):p},e.axis=function(t){return arguments.length?(y=t,e):y},e.margin=function(t){return arguments.length?(m=t,e):m},e.value=function(t){return arguments.length?(o&&n(r(t)),o=t,e):o},e.snap=function(t){return arguments.length?(b=t,e):b},e.scale=function(t){return arguments.length?(l=t,e):l},t.rebind(e,k,"on"),e}});