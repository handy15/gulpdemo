<!DOCTYPE HTML><html><head><meta charset="utf-8"><title>高德地图v1.3.11-关键字检索</title><style type="text/css">.demo{width:760px;height:500px;margin:30px auto 0 auto;font-size:14px}.demo p{line-height:30px}</style><link rel="stylesheet" type="text/css" href="/gulpdemo/plugin/bootstrap-3.3.5/css/bootstrap.css?v=957474c344"><link rel="stylesheet" type="text/css" href="/gulpdemo/css/common.css?v=1d2e760412"><link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css"><style type="text/css">.s_btn{width:50px;height:25px;color:#fff;letter-spacing:1px;background:#3385ff;outline:medium;-webkit-appearance:none;-webkit-border-radius:0}#myPageTop{left:10px;right:auto}.bottom{border-top:1px solid #666;position:absolute;background-color:#f1f1f1;bottom:0;left:0;width:100%;z-index:999;font-size:12px}.bottom .oper{line-height:25px;text-align:center}.uhide{display:none}.amap-info-close{display:none}.amap_lib_placeSearch_poi{background:url(/gulpdemo/img/gaode/mark_b.png?v=181fef5d29) no-repeat;height:31px;width:19px;cursor:pointer;left:-1px;text-align:center;color:#fff;font:12px arial,simsun,sans-serif;padding-top:3px}#panel{max-height:150px;overflow-y:auto;display:none}.my-poi-panel .my-per-poi{padding:3px 0;border-bottom:1px solid #00a6ac}.my-poi-panel .my-poi-name{font-size:14px;color:#00a6ac;margin-bottom:3px}.my-poi-panel .my-poi-other{line-height:16px;color:#333}.activity-poi{background-color:#f6f6f6}div.info{position:relative;z-index:100;border:1px solid #BCBCBC;box-shadow:0 0 10px;border-radius:8px;background-color:rgba(255,255,255,.9);transition-duration:.25s}div.info:hover{box-shadow:0 0 15px #0CF}div.info-top{position:relative;background:none repeat scroll 0 0 #F9F9F9;border-bottom:1px solid #CCC;border-radius:5px 5px 0 0;min-height:30px}div.info-top div{display:inline-block;color:#333;font-size:14px;font-weight:700;line-height:31px;padding:0 10px}div.info-top img{position:absolute;top:10px;right:10px;transition-duration:.25s}div.info-top img:hover{box-shadow:0 0 5px #000}div.info-middle{font-size:12px;padding:10px;line-height:21px}div.info-bottom{height:0;width:100%;clear:both;text-align:center}div.info-bottom img{position:relative;z-index:104;width:20px}.autoclass{width:625px;clear:both;position:absolute;z-index:999999}.autobox{overflow:auto;width:95%;border:1px solid gray;display:none;background:#fff}.map-place{position:relative;width:98%;height:550px}</style><link rel="stylesheet" href="http://cache.amap.com/lbs/static/main.css?v=1.0"></head><body><header class="header"><nav><ul class="navigation"><li><a href="/gulpdemo/index.html" target="_self" title="返回首页" class="home"></a></li><li><a href="#">移动端</a></li><li><a href="/gulpdemo/html/webDesign/vertical_align.html" target="_self">网页布局</a></li><li><a href="/gulpdemo/html/javascript/chinamap.html" target="_self">javascript & JQuery</a></li></ul></nav></header><div class="container01"><div class="c-left"><input type="hidden" value="3" id="menuId"><div class="side-menu"><ul class="side-menu-list"><li><a href="#"><i class="glyphicon glyphicon-menu-right"></i>地图</a><ul class="side-menu-child hide"><li><a href="/gulpdemo/html/javascript/chinamap.html">中国地图</a></li><li><a href="/gulpdemo/html/javascript/gaode/gdMap.html">高德地图</a></li><li><a href="/gulpdemo/html/javascript/gaode/map.html">高德地图-搜索结果列表</a></li><li><a href="/gulpdemo/html/javascript/gaode/poi.html">高德地图-iframe传参</a></li><li><a href="/gulpdemo/html/javascript/baidu-map.html">百度地图</a></li></ul></li><li><a href="#"><i class="glyphicon glyphicon-menu-right"></i>电站工具</a><ul class="side-menu-child hide"><li><a href="/index.php/Home/Page/index?page_id=113">光照参数资源列表</a></li><li><a href="/index.php/Home/Page/index?page_id=112">光照资源参数详情</a></li><li><a href="/index.php/Home/Page/index?page_id=114">补贴政策详情</a></li><li><a href="/index.php/Home/Page/index?page_id=115">补贴政策库列表</a></li><li><a href="/index.php/Home/Page/index?page_id=167">踏勘报告首页</a></li></ul></li></ul></div></div><div class="c-right"><div class="map-place"><div style="position:absolute;top:10px;right:10px;z-index:1;padding:5px;background-color:#fff"><input type="button" value="确定" class="s_btn" onclick="selectThisPoi(event)"></div><div id="container"></div><div id="myPageTop"><table><tr><td><label>请输入关键字：</label></td></tr><tr><td><input id="tipinput"></td></tr></table></div><div id="bottom" class="bottom uhide"><div class="oper" onclick="operBotton(this)" status="hide">展开列表</div><div id="panel" class="my-poi-panel"></div></div></div></div></div><footer class="footer"><p>Author: wangyaru</p><p>Created time: 2016/02/15</p><p>&copy;forever</p></footer><script type="text/javascript" src="/gulpdemo/js/jquery-1.12.1.js?v=62f69d29b6"></script><script type="text/javascript" src="/gulpdemo/plugin/bootstrap-3.3.5/js/bootstrap.js"></script><script type="text/javascript" src="/gulpdemo/js/main.js?v=04b692f78d"></script><script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&plugin=AMap.Autocomplete,AMap.PlaceSearch,AMap.Geocoder&key=7247a0fd3bde7acd8f2e750ddda7419f"></script><script type="text/javascript">function operBotton(t){var a=$(t);"show"==a.attr("status")?(a.parent().find("#panel").hide(),a.html("展开列表"),a.attr("status","hide")):(a.parent().find("#panel").show(),a.html("收起列表"),a.attr("status","show"))}</script><script type="text/javascript">function onComplete(e){createSelfMarker(e)}function onError(){alert("GPS定位当前位置失败")}function createSelfMarker(e,a){var o=e?e.position.getLng():a.lnglat.getLng(),r=e?e.position.getLat():a.lnglat.getLat();map.clearMap(),marker||(marker=new AMap.Marker),infowindow||(infowindow=new AMap.InfoWindow({isCustom:!0,size:new AMap.Size(80,0),offset:new AMap.Pixel(8,-45)})),marker.setMap(map),marker.setPosition([o,r]),$("#bottom").addClass("uhide"),regeocoder(marker.getPosition(),!0),map.setZoom(18),map.setCenter([o,r])}function closeInfoWindow(){map.clearInfoWindow()}function createInfoWindow(e,a){var o=document.createElement("div");o.className="info";var r=document.createElement("div");r.className="info-top";var t=document.createElement("div");t.innerHTML=e;var n=document.createElement("img");n.src="/gulpdemo/img/gaode/close2.gif?v=86830ca017",n.onclick=closeInfoWindow,r.appendChild(t),o.appendChild(r);var i=document.createElement("div");i.className="info-middle",i.innerHTML=a,o.appendChild(i);var c=document.createElement("div");c.className="info-bottom";var d=document.createElement("img");return d.src="/gulpdemo/img/gaode/sharp.png?v=f41bd1e208",c.appendChild(d),o.appendChild(c),o}function regeocoder(e,a){var o=new AMap.Geocoder({radius:500,extensions:"all"});o.getAddress(e,function(e,o){"complete"===e&&"OK"===o.info&&(selectedPoi=o,markerData=o,a&&geocoder_CallBack(o))})}function geocoder_CallBack(e){var a=e.regeocode.addressComponent.building,o=e.regeocode.formattedAddress;infowindow.setContent(createInfoWindow(a,"<div>地址："+o+"</div>")),infowindow.open(map,marker.getPosition())}function selectThisPoi(e){if(e.stopPropagation(),!selectedPoi)return void alert("对不起，没有坐标点或坐标点数据加载异常，请重新尝试！");var a=selectedPoi.regeocode.addressComponent,o=a.province,r=a.city?a.city:o,t=a.district,n=a.township,i=selectedPoi.regeocode.formattedAddress,c=selectedPoi.regeocode.crosses[0].location,d={};d.province=o,d.city=r,d.area=t,d.detail=n,d.fulladdress=i,d.positionJson=c;var s=JSON.stringify(d),l=window.parent;l&&l.returnMapVal?l.returnMapVal?l.returnMapVal(s):l.postMessage("returnMapVal",s):alert(s)}function placeSearch_CallBack(e){for(var a=e.poiList.pois,o="",r=a.length,t=0;r>t;t++)o+='<div class="my-per-poi" onclick="activityPoi(this)" idx="'+t+'">',o+='<div class="amap-marker-content" style="opacity: 1; float: left; padding: 8px">',o+='<div class="amap_lib_placeSearch_poi">'+(t+1)+"</div>",o+="</div>",o+='<div class="my-poi-name">',o+="名称："+a[t].name,o+="</div>",o+='<div class="my-poi-other">',o+="地址："+a[t].address,o+="</div>",o+='<div class="my-poi-other">',o+="电话："+a[t].tel,o+="</div>",o+="</div>",addSearchMarker(t,a[t]);map.setFitView(),$("#panel").html(o)}function activityPoi(e){$(".my-per-poi").removeClass("activity-poi"),$(e).addClass("activity-poi");var a=$(e).attr("idx");infoWinArr[a].open(map,markerArr[a]),regeocoder([markerArr[a].lat,markerArr[a].lng],!1)}function select(e){map.clearMap(),placeSearch.setCity(e.poi.adcode),placeSearch.search(e.poi.name),$("#bottom").removeClass("uhide")}function addSearchMarker(e,a){var o=a.location.getLng(),r=a.location.getLat(),t={map:map,icon:"/gulpdemo/img/gaode/mark_b_"+(e+1)+".png",position:new AMap.LngLat(o,r)},n=new AMap.Marker(t);markerArr.push(new AMap.LngLat(o,r));var i=new AMap.InfoWindow({content:createInfoWindow(a.name,"<div>地址："+a.address+"</div>"),isCustom:!0,size:new AMap.Size(80,0),offset:new AMap.Pixel(8,-45)});infoWinArr.push(i),AMap.event.addListener(n,"click",function(){regeocoder(n.getPosition(),!1),i.open(map,n.getPosition());var a=$(".my-per-poi");a&&a.length>0&&(a.removeClass("activity-poi"),$(".my-per-poi[idx="+e+"]").addClass("activity-poi"))})}function getMyLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition,locationError):alert("该浏览器不支持获取地理位置。")}function showPosition(e){alert("纬度: "+e.coords.latitude+"\n经度: "+e.coords.longitude)}function locationError(e){switch(e.code){case e.PERMISSION_DENIED:alert("User denied the request for Geolocation.用户拒绝对获取地理位置的请求");break;case e.POSITION_UNAVAILABLE:alert("Location information is unavailable.位置信息是不可用的");break;case e.TIMEOUT:alert("The request to get user location timed out.请求用户地理位置超时");break;case e.UNKNOWN_ERROR:alert("An unknown error occurred.未知错误")}}var map,marker,infowindow,markerData,selectedPoi;map=new AMap.Map("container",{zoom:11,resizeEnable:!0}),AMap.event.addListener(map,"click",function(e){markerData=null,createSelfMarker(null,e)}),map.plugin("AMap.Geolocation",function(){var e=new AMap.Geolocation({enableHighAccuracy:!0,timeout:5e3,convert:!1,showButton:!1,zoomToAccuracy:!0});map.addControl(e),AMap.event.addListener(e,"complete",onComplete),AMap.event.addListener(e,"error",onError),e.getCurrentPosition()});var placeSearch=new AMap.PlaceSearch({pageSize:10});AMap.event.addListener(placeSearch,"complete",function(e){markerArr.splice(0,markerArr.length),infoWinArr.splice(0,infoWinArr.length),placeSearch_CallBack(e)});var autoOptions={input:"tipinput"},auto=new AMap.Autocomplete(autoOptions);AMap.event.addListener(auto,"select",select);var markerArr=new Array,infoWinArr=new Array</script></body></html>